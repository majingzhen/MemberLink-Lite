<!--pages/asset/balance/balance.wxml-->
<view class="balance-container">
  <!-- ç­›é€‰åŒºåŸŸ -->
  <view class="filter-section">
    <fresh-card shadow="{{true}}" radius="medium">
      <view class="filter-content">
        <!-- ç±»å‹ç­›é€‰ -->
        <view class="filter-item">
          <view class="filter-label">ç±»å‹ç­›é€‰</view>
          <picker 
            mode="selector" 
            range="{{typeOptions}}" 
            range-key="label"
            bindchange="onTypeChange"
          >
            <view class="picker-display">
              <text>{{filters.type ? getTypeText(filters.type) : 'å…¨éƒ¨ç±»å‹'}}</text>
              <text class="picker-arrow">â€º</text>
            </view>
          </picker>
        </view>

        <!-- æ—¶é—´ç­›é€‰ -->
        <view class="filter-row">
          <view class="filter-item">
            <view class="filter-label">å¼€å§‹æ—¶é—´</view>
            <picker 
              mode="date" 
              value="{{filters.startTime}}"
              bindchange="onStartTimeChange"
            >
              <view class="picker-display">
                <text>{{filters.startTime || 'é€‰æ‹©æ—¥æœŸ'}}</text>
                <text class="picker-arrow">â€º</text>
              </view>
            </picker>
          </view>

          <view class="filter-item">
            <view class="filter-label">ç»“æŸæ—¶é—´</view>
            <picker 
              mode="date" 
              value="{{filters.endTime}}"
              bindchange="onEndTimeChange"
            >
              <view class="picker-display">
                <text>{{filters.endTime || 'é€‰æ‹©æ—¥æœŸ'}}</text>
                <text class="picker-arrow">â€º</text>
              </view>
            </picker>
          </view>
        </view>

        <!-- æ¸…é™¤ç­›é€‰ -->
        <view wx:if="{{filters.type || filters.startTime || filters.endTime}}" class="filter-actions">
          <fresh-button
            type="secondary"
            size="small"
            text="æ¸…é™¤ç­›é€‰"
            bindtap="onClearFilters"
          />
        </view>
      </view>
    </fresh-card>
  </view>

  <!-- è®°å½•åˆ—è¡¨ -->
  <view class="records-section">
    <view wx:if="{{records.length > 0}}" class="records-list">
      <view 
        wx:for="{{records}}" 
        wx:key="id"
        class="record-item"
      >
        <fresh-card shadow="{{true}}" radius="medium">
          <view class="record-content">
            <!-- è®°å½•ä¿¡æ¯ -->
            <view class="record-info">
              <view class="record-header">
                <view class="record-type" style="color: {{getTypeColor(item.type)}}">
                  {{getTypeText(item.type)}}
                </view>
                <view class="record-amount" style="color: {{item.amount >= 0 ? '#67c23a' : '#f56c6c'}}">
                  {{item.amount >= 0 ? '+' : ''}}Â¥{{formatMoney(item.amount)}}
                </view>
              </view>

              <view wx:if="{{item.remark}}" class="record-remark">
                {{item.remark}}
              </view>

              <view class="record-footer">
                <view class="record-time">{{getRelativeTime(item.created_at)}}</view>
                <view class="record-balance">ä½™é¢: Â¥{{formatMoney(item.balance_after)}}</view>
              </view>
            </view>
          </view>
        </fresh-card>
      </view>

      <!-- åŠ è½½æ›´å¤š -->
      <view wx:if="{{pagination.hasMore}}" class="load-more">
        <view wx:if="{{loadingMore}}" class="loading-text">
          <text>åŠ è½½ä¸­...</text>
        </view>
        <view wx:else class="load-more-text">
          <text>ä¸Šæ‹‰åŠ è½½æ›´å¤š</text>
        </view>
      </view>

      <!-- æ²¡æœ‰æ›´å¤š -->
      <view wx:else class="no-more">
        <text>æ²¡æœ‰æ›´å¤šè®°å½•äº†</text>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:else class="empty-state">
      <fresh-card type="info" shadow="{{true}}" radius="large">
        <view class="empty-content">
          <view class="empty-icon">ğŸ“Š</view>
          <view class="empty-title">æš‚æ— ä½™é¢è®°å½•</view>
          <view class="empty-desc">æ‚¨è¿˜æ²¡æœ‰ä»»ä½•ä½™é¢å˜åŠ¨è®°å½•</view>
        </view>
      </fresh-card>
    </view>
  </view>
</view>